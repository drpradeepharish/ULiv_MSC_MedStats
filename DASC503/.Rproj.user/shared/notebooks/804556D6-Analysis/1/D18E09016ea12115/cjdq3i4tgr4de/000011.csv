"0","# Filter patients diagnosed with cancer based on predefined cutoffs and discretise ages"
"0","tblDataSummary %>%"
"0","  filter(ever_diagnosed == 1,"
"0","         (age >= intAgeMin &"
"0","            age <= intAgeMax)) %>%"
"0","  mutate(ageband = chop_width("
"0","    age,"
"0","    start = 25,"
"0","    width = 5,"
"0","    labels = lbl_discrete()"
"0","  )) -> tblNumerator"
"0",""
"0","# Save the filtered dataset as a CSV file"
"0","tblNumerator %>% write_csv(""tblNumerator.csv"")"
"0",""
"0","# Creating an empty tibble with no unique diagnoses of cancer to capture those years, sex, qimd, etc in which there are no diagnoses of cancer (incidence has been 0). As such, these data are filtered out in our numerator calculations. This will introduce it back in. This is so that we can plot those years with no incidences easily "
"0","expand_grid("
"0","  sex = unique(tblNumerator$sex) %>% as.character(),"
"0","  sha = unique(tblNumerator$sha) %>% as.character(),"
"0","  qimd = unique(tblNumerator$qimd) %>% as.character(),"
"0","  ethnicity = unique(tblNumerator$ethnicity) %>% as.character(),"
"0","  smoking_status = unique(tblNumerator$smoking_status) %>% as.character(),"
"0","  ageband = santoku::chop_width("
"0","    seq(intAgeMin, intAgeMax, by = 5),"
"0","    start = 25,"
"0","    width = 5,"
"0","    labels = lbl_discrete()"
"0","  )"
"0",") %>%"
"0","  mutate("
"0","    pid = 0,"
"0","    ever_diagnosed = 0,"
"0","    ever_died = 0,"
"0","    ever_died_cancer = 0,"
"0","    dob = NA,"
"0","    censor_date = NA,"
"0","    age = NA,"
"0","  ) %>%"
"0","  bind_rows(tblNumerator) -> tblGraphNumerator"
"0",""
